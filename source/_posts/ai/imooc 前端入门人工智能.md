---
title: imooc 前端入门人工智能
date: 
categories:
- 人工智能
tags:
- imooc 实战
- 待续
---

# 第2章 机器学习与神经网络简介

## 2-1 机器学习简介

### 2-1-1 机器学习是什么？

* 机器学习是指对能通过 ***经验*** 自动改进的计算机算法的研究。
* 机器学习使用 ***数据*** 或以往的 ***经验*** ，以此优化计算机程序的性能标准。

### 2-1-2 机器学习例子（以往的经验 / 数据）

* 用很多男子的脚长的平均值，估计男子脚长
* 线性回归
  * 身高体重预测
  * 房价预测（面积、价格）
* 逻辑回归
* 语音助手

### 2-1-3 为何要用机器学习？

* 有些棘手问题只能用机器学习来解决（程序员写代码来解决，可能吗？）
* 获取数据比编写规则更加容易
* GPU 等计算能力显著提升（使用机器学习成本将下来了）

### 2-1-3 机器学习如何运作？

* 神经网络（重点）
* 决策树、支持向量机、贝叶斯分类器、强化学习....



## 2-2 神经网络简介

* 运算模型（输入到输出的映射）

* 人工神经网络是一种运算模型（就是输入输出的映射），由大量的节点（或称神经元）之间相互连接构成
* 下图，用输入相亲对象的信息，得出是否满意。

![image-20200208093440239](/Users/lvjiawen/Library/Application Support/typora-user-images/image-20200208093440239.png)

* 其他复杂因素：
  * 偏置
  * 激活函数，到一定程度就可以了，不要再线性增长了
  * 权重

### 总结

* 每个神经元里存储着若干权重（weight）、偏置（bias）、和一个激活函数（activation）
* 输入乘上权重加上偏置，经过激活函数得到输出
* 激活函数用于添加一些非线性的变化
* 神经网络通常包含一个输入层、若干隐藏层，一个输出层，输入层通常不用于计算神经网络的层数



### 2-3 神经网络的训练

### 什么是神经网络的训练？

* 给大量输入和输出，算出神经网络里所有神经元的权重、偏置，然后给定新的输入，可以算出新的输出
* 在机器学习力，输入输出被称为 ***特征*** 和 ***标签*** ，大连输入输出被称为 ***训练集***

*  给1000 个相亲对象的数据（特征），和对应的满意程度（标签），训练完后，给一份新的相亲对象的数据，就可以判断满意程度了。

### 如何训练神经网络？

* 初始化：随机生成一些权重和偏置
* 计算损失：给定特征，计算出标签，得到它与真实标签差的多远
* 优化：微调权重和偏置，使损失变小

### 前向传播与反向传播

* 前向传播：将训练的数据的特征送入网络，得到标签（第一 =》 第二层 =》。。。 =》 最后一层）
* 反向传播：计算损失并优化（先调整最后一层，再调整倒数第二层）
  * 注：原理见微积分的链式法则

### 如何计算损失？

* 使用 ***损失函数***（科学家研究出来的）
* 例如：均方误差、对数损失、交叉熵
* 了解原理即可，工作中可以直接从第三方库中调用

### 如何优化？

* 使用 ***优化器*** （科学家研究出来的）
* 例如：随机梯度下降（SGD）、Adam
* 了解原理即可，工作中可以直接从第三方库中调用



# 第3章 Tensorflow.js 简介

## 3-1 Tensorflow.js 是什么

### Tensorflow.js 是什么

* 一个用 javascript 实现的机器学习库
* 可以直接在浏览器和 Node.js 中使用机器学习技术了

### Tensorflow.js 具体功能

* 运行现有模型
* 重新训练现有模型
* 使用 javascript 开发机器学习模型



## 3-2 安装 Tensorflow.js 

### 在浏览器中安装

* 使用 script 标签
  * 使用 `npm i nrm -g`，然后 `nrm ls`，然后 `nrm use taobao`，安装 http-server `npm i http-server -g`，使用http-server 命令行输入 `hs` 即可
* 使用 npm 包安装，并使用 parcel 或者 webpack 构建
  * `npm install @tensorflow/tfjs`
  * `npm install -g parcel-bundler`

### 在 Node.js 中安装

* 安装带有原生 C++ 绑定的 TensorFlow.js（推荐，但是麻烦）
  * 安装 node-gyp，专门用来构建底层库
    * windows：`npm i node-gyp windows-build-tools@4.0.0 -g`
  * 
* 在 GPU 上安装 TensorFlow.js
* 安装纯 Javascript 版本，这是性能方面最慢的选项



## 3-3 为何要用 Tensor？

### 什么是 Tensor？

* 中文名字是 ***张量***
* 张量是向量和矩阵向更高维度的推广
* 相当于多维数组，但是有别的属性，例如形状、大小，关注rank，size，shape

### Tensor 和机器学习有什么关系？

* 神经网络是什么样子

* 如果放你设计神经网络的数据结构，你会怎么设计？

  * 上面例子中
  * 五官、身材、学历、家境，作为输入的数值
  * 那形象这个神经元举例，他要存储五官、身材、学历、家境这四个输入的权重。财富、品质、有趣是一样的
  * 形象、财富、品质、有趣乘以各自的权重得到满意程度，满意程度之中包含了形象、财富、品质、有趣的权重
  * 按照这个例子，每一个神经元是一个四个元素的数组，每一层的神经元可以设计成一个二维数组
  * 这个例子中一层要进行两次循环

  ### 神经网络数据结构设计

  * 神经网络每一层要存储 N 堆数据
  * N 层的 For 循环运算
  * Tensor 作为高位数据结构完美解决以上问题

```javascript
import * as tf from '@tensorflow/tfjs';
// 传统 for 循环
const input = [1, 2, 3, 4];
const w = [[1, 2, 3, 4], [2, 3, 4, 5], [3, 4, 5, 6], [4, 5, 6,7]];
const output = [0, 0, 0, 0];

for (let i = 0; i < w.length; i++) {
  for (let j = 0; j < input.length; j++) {
    output[i] += input[j] * w[i][j]
  }
}
console.log(output)

// 使用 tensor
tf.tensor(w).dot(tf.tensor(input)).print();
```

> 数学原理，点乘，旋转



# 第4章 线性回归

## 4-1 线性回归任务简介

### 什么是线性回归？

* 利用数理统计中回归分析，来确定两种或两种以上变量间相互依赖的定量关系的一种统计分析方法
* 例子：身高体重数据，预测身高体重

### 操作步骤

* 准备、可视化训练数据
* 使用 Tensorflow.js 的 API 构建神经网络
* 训练模型并预测

## 4-2 准备、可视化训练数据

### 操作步骤

* 准备线性回归训练数据
* 使用 tfvis 可视化训练数据

```js
import * as tfvis from '@tensorflow/tfjs-vis'

window.onload = () => {
  const xs = [1, 2, 3, 4];
  const ys = [1, 3, 5, 7];

  // 散点图
  tfvis.render.scatterplot(
    { name: '线性回归训练集' },
    { values: xs
      .map((x, i) => {
        return {
          x,
          y: ys[i]
        }
      })
    },
    { xAxisDomain: [0, 5], yAxisDomain: [0, 8] }
  )
};
```



### 4-3 定义模型结构：单层单个神经元组成的神经网络

### 操作步骤

* 初始化一个神经网络模型
* 为神经网络添加层
* 设计层的神经元个数 和 输入形状（inputShape）



```js
// 连续的模型，这一层的输入是下一层的输出
  const model = tf.sequential();

  // 给模型添加层
  // dense 全链接层
  model.add(tf.layers.dense({
    units: 1, // 神经元个数
    inputShape: [1], // 输入形状
  }))
```

